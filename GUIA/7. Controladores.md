# Controllers

Un Controlador es el corazón de tu API RESTful en .NET. Es la clase responsable de recibir peticiones HTTP (como GET, POST, PUT, DELETE) y de devolver la respuesta correspondiente.

Para crear un controlador: click derecho sobre la carpeta Controllers -> add -> Controller -> Controller Empty (usamos nombre en prural ej: PersonajesController.cs)

1. Herencia:
   La clase debe heredar de ControllerBase. Esta clase base proporciona funcionalidades esenciales como el acceso al ModelState y a los métodos para devolver respuestas HTTP (ej: Ok(), NotFound()).

2. Atributos Esenciales de Configuración:
   Para que .NET sepa que tu clase es una API y cómo debe enrutar las peticiones, debes usar dos atributos de configuración clave
   A) [ApiController] -> Habilita el comportamiento específico de API. Activa característica
   B) [Route("api/[controller]")] -> Define la plantilla base de la URL para todos los métodos de acción dentro de este controlador. La convención más usada es incluir el nombre del controlador. Nota: Poner manualmente el nombre puede evitar futuros errores en caso que la aplicación escale.

### Cada método de acción debe estar decorado con un atributo que especifique el verbo HTTP que manejará:

GET [HttpGet] Obtener datos.
POST [HttpPost] Crear un nuevo recurso.
PUT [HttpPut] Reemplazar un recurso existente.
DELETE [HttpDelete] Eliminar un recurso.

```csharp
[HttpGet] // Ruta final: /api/personajes (Obtiene todos)
public IActionResult ObtenerTodos() { ... }
[HttpGet("{id}")] // Ruta final: /api/personajes/{id} (Obtiene uno específico)
public IActionResult ObtenerPorId(int id) { ... }
```

### Devolución del Resultado

Los métodos de acción deben devolver un tipo que represente una respuesta HTTP, incluyendo el código de estado (200 OK, 404 Not Found, etc.). El tipo más común es IActionResult o ActionResult<T>.
Usando la herencia de ControllerBase, tienes métodos helper para construir estas respuestas:

| Método Helper          | Código HTTP | Uso                                                                                       |
| ---------------------- | ----------- | ----------------------------------------------------------------------------------------- |
| `Ok(objeto)`           | 200         | La solicitud fue exitosa y devuelve datos.                                                |
| `CreatedAtAction(...)` | 201         | Se creó exitosamente un nuevo recurso (típico de POST).                                   |
| `NoContent()`          | 204         | La solicitud fue exitosa, pero no hay datos para devolver (típico de PUT/DELETE exitoso). |
| `NotFound()`           | 404         | El recurso solicitado no existe.                                                          |
| `BadRequest()`         | 400         | La solicitud es inválida (ej: datos de entrada incorrectos o ModelState con errores).     |

### Ejemplo de controlador

```csharp
[ApiController] // 1. Indica que es una clase de API
[Route("api/[controller]")] // 2. Define la ruta base: /api/personajes
public class PersonajesController : ControllerBase // 3. Hereda de ControllerBase
{
   // inyección de dependencias

   // metodos hhtp
}
```
